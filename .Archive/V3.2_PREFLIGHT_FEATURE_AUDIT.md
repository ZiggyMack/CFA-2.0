# 🔍 CFA v3.2 PRE-FLIGHT - Feature Completeness Audit

**Date:** October 25, 2025  
**Purpose:** Catch ANY forgotten/tabled features before v3.2 ships  
**Method:** Cross-reference docs, reboot packages, milestone files, code

---

## ✅ **CONFIRMED MISSING (Must Fix in v3.2):**

### **1. Guardrails - 3 of 4 Missing** ⚠️ **CRITICAL**
**Status:** Only Lever-Coupling implemented

**Missing:**
- ❌ **BFI-Sensitivity** - Prevents axiom inflation (ΔYPA/ΔBFI > 0.4)
- ❌ **Weight-Inversion Alarm** - Detects extreme scenario weights (<0.3× or >3×)
- ❌ **Symmetry Audit Summary** - Exists in tab4, but should appear in Guardrails tab too

**Impact:** User sees incomplete fairness system (breaks "All Named, All Priced" promise)

**Evidence:**
- Manual PDF lists 4 guardrails (page references BFI-Sensitivity, Weight-Inversion)
- console.py tab3 only shows Lever-Coupling
- app.py only has `guardrail_lever_coupling()` function

**Action:** Add 3 missing guardrail functions + update console.py tab3

---

## 📋 **DEFERRED FEATURES (Documented, Not Yet Implemented):**

### **2. Preset Framework Library - 6 Placeholder Frameworks**
**Status:** MdN ✅, CT ✅, but 6 marked "coming soon"

**Placeholders:**
- 🔜 Buddhism
- 🔜 Stoicism  
- 🔜 Pragmatism
- 🔜 Process Theology
- 🔜 Secular Humanism
- 🔜 Metaphysical Naturalism

**Decision:** These are INTENTIONALLY deferred (not a bug)  
**Action:** No changes needed for v3.2 (roadmap for v4.0+)

---

### **3. URL-Based Sharing**
**Status:** Export JSON works, but no URL parameter encoding

**From README.md (line 440):**
> "Future Enhancements: URL-based sharing (encode state in query params)"

**Use Case:** Share audit configuration via link instead of file

**Decision:** Tabled for v3.3+ (not critical)  
**Action:** No changes needed for v3.2

---

### **4. Historical Tracking**
**Status:** Single-run only, no evolution tracking

**From README.md (line 441):**
> "Future Enhancements: Historical tracking (how scores evolved)"

**Use Case:** Track how your worldview scores change over time

**Decision:** Tabled for v4.0+ (requires backend/database)  
**Action:** No changes needed for v3.2

---

### **5. Community Submissions Portal**
**Status:** No submission system, only manual JSON export

**From README.md (line 443):**
> "Future Enhancements: Community submissions portal"

**Use Case:** Users submit audited frameworks for review/inclusion

**Decision:** Tabled for v4.0+ (requires moderation system)  
**Action:** No changes needed for v3.2

---

### **6. Dark Mode**
**Status:** Light mode only

**From README.md (line 445):**
> "Future Enhancements: Dark mode"

**Decision:** Nice-to-have, not core functionality  
**Action:** No changes needed for v3.2

---

### **7. Export Charts as PNG/PDF**
**Status:** Can only export JSON data, not visualizations

**From MILESTONE docs:**
> "To-Do: Export charts as PNG/PDF"

**Decision:** Tabled for v3.3+ (Plotly has this capability, just not wired up)  
**Action:** No changes needed for v3.2

---

### **8. "Audit Story" Tooltips on Framework Names**
**Status:** Badges show convergence, but no hover tooltips explaining audit process

**From MILESTONE docs:**
> "To-Do: Audit Story tooltips"

**Decision:** Could add in v3.2 if time permits (low priority)  
**Action:** Optional enhancement

---

## 🔎 **DESIGN PATTERNS TO VERIFY:**

### **9. Fallibilism Bonus Application**
**Status:** ✅ Implemented correctly

**Check:** Does `apply_fallibilism_bonus()` only trigger when:
- Toggle is ON
- Framework admits limits

**Verified:** Yes, line 63-66 in app.py
```python
def apply_fallibilism_bonus(cci: float, bonus: str, admitted_limits: bool = True) -> float:
    if bonus == "ON" and admitted_limits:
        return min(cci + 0.3, 10.0)
    return cci
```

**Action:** ✅ No changes needed

---

### **10. Parity Toggle Behavior**
**Status:** ✅ Implemented correctly

**Check:** Does Parity OFF actually cut MG in half?

**Verified:** Yes, line 68-69 in app.py
```python
def parity_weight(mg: float, parity: str) -> float:
    return mg if parity == "ON" else 0.5 * mg
```

**Action:** ✅ No changes needed

---

### **11. BFI Debt Weight Calculation**
**Status:** ✅ Implemented correctly

**Check:** Does "Weighted" debt option apply 1.2× multiplier?

**Verified:** Yes, line 71-73 in app.py
```python
def bfi_total(axioms: int, debts: int, debt_weight: str) -> float:
    w = 1.0 if debt_weight == "Equal_1.0x" else 1.2
    return axioms + w * debts
```

**Action:** ✅ No changes needed

---

### **12. Composite PF Calculation**
**Status:** ✅ Implemented correctly

**Check:** Do the 3 PF-Type options work as documented?
- Instrumental: 100% instrumental
- Composite 70/30: 70% instrumental, 30% existential
- Holistic 50/50: 50/50 split

**Verified:** Yes, line 56-61 in app.py
```python
def composite_pf(pf_inst: float, pf_exist: float, pf_type: str) -> float:
    if pf_type == "Instrumental":
        return pf_inst
    if pf_type == "Holistic_50_50":
        return 0.5 * pf_inst + 0.5 * pf_exist
    return 0.7 * pf_inst + 0.3 * pf_exist
```

**Action:** ✅ No changes needed

---

### **13. YPA Trinity Scenario Weights**
**Status:** ✅ Implemented correctly

**Check:** Are scenario weights matching the documented values?
- Neutral: All levers 1×
- Existential: EDB 2×, MG 2×
- Empirical: CCI 1.5×, PF 2×

**Verified:** Yes, line 82-86 in app.py
```python
scenarios_weights = {
    "Neutral": {"CCI": 1.0, "EDB": 1.0, "PF": 1.0, "AR": 1.0, "MG": 1.0},
    "Existential": {"CCI": 1.0, "EDB": 2.0, "PF": 1.0, "AR": 1.0, "MG": 2.0},
    "Empirical": {"CCI": 1.5, "EDB": 1.0, "PF": 2.0, "AR": 1.0, "MG": 1.0},
}
```

**Action:** ✅ No changes needed

---

### **14. Symmetry Audit Toggle Tests**
**Status:** ✅ Implemented correctly

**Check:** Does symmetry_audit() test all 3 toggle inversions?
- Lever-Parity flip
- All PF-Type options
- Fallibilism flip

**Verified:** Yes, line 103-126 in app.py

**Action:** ✅ No changes needed

---

## 🧪 **POTENTIAL EDGE CASES TO TEST:**

### **15. Division by Zero Protection**
**Status:** ✅ Protected

**Check:** What happens if BFI = 0?

**Verified:** Line 94 in app.py handles this:
```python
results[name] = {"total": total, "YPA": total / bfi if bfi > 0 else 0}
```

**Action:** ✅ No changes needed

---

### **16. Lever Bounds Enforcement**
**Status:** ✅ Streamlit sliders enforce 0-10 range

**Check:** Can users set levers outside 0-10?

**Verified:** Slider definitions in console.py enforce bounds:
```python
st.slider("CCI", 0.0, 10.0, ...)
```

**Action:** ✅ No changes needed

---

### **17. Session State Initialization**
**Status:** ✅ Properly initialized

**Check:** Does page navigation maintain state?

**Verified:** app.py line 19 initializes page state:
```python
if 'page' not in st.session_state:
    st.session_state.page = 'landing'
```

**Action:** ✅ No changes needed

---

## 🎯 **FEATURES READY FOR v3.2 (User Requested):**

### **18. Preset Mode Spectrum** 🆕
**Status:** Designed, ready to implement

**Modes to add:**
- 🔬 Skeptic Mode (MdN-optimized) - ✅ Already in brute_ledger.py
- 🤝 Diplomat Mode (bridge-builder)
- 🙏 Seeker Mode (CT-leaning)
- 👿 Zealot Mode (CT-optimized)

**Action:** ✅ Implement in v3.2 (move Skeptic to console, add 3 new modes)

---

### **19. Quiz System** 🆕
**Status:** Designed, ready to implement

**Flow:**
- 5 questions detect user's epistemology
- Auto-load appropriate preset mode
- Optional: Ask for real-world scenario after quiz

**Action:** ✅ Implement in v3.2

---

## 📊 **SUMMARY: WHAT NEEDS TO HAPPEN IN v3.2**

### **Must Fix (Critical):**
1. ⚠️ **Add 3 missing guardrails** (BFI-Sensitivity, Weight-Inversion, Symmetry summary)

### **Should Add (User Requested):**
2. ✅ **Preset Mode Spectrum** (4 modes: Skeptic, Diplomat, Seeker, Zealot)
3. ✅ **Quiz System** (bias detection + mode auto-load)

### **Optional Enhancements:**
4. 💡 "Audit Story" hover tooltips on framework names
5. 💡 Convergence badges on more UI elements

### **Deferred to Future Versions:**
- URL-based sharing (v3.3+)
- Historical tracking (v4.0+)
- Community portal (v4.0+)
- Dark mode (whenever)
- Chart export PNG/PDF (v3.3+)
- Additional framework audits (ongoing)

---

## ✅ **VERIFICATION CHECKLIST FOR v3.2:**

Before shipping v3.2, confirm:

- [ ] All 4 guardrails display in console.py tab3
- [ ] Guardrail functions exist in app.py or utils/calculations.py
- [ ] Skeptic Mode moved from brute_ledger to console
- [ ] 3 new preset modes added (Diplomat, Seeker, Zealot)
- [ ] Quiz system implemented with 5 questions
- [ ] Quiz auto-loads detected preset mode
- [ ] All existing features still work (regression test)
- [ ] README.md updated with v3.2 features
- [ ] CHANGELOG.md documents v3.2 changes

---

## 🔥 **FINAL ASSESSMENT:**

### **What We Found:**
1. **Critical Gap:** 3 missing guardrails (user saw this in screenshot)
2. **Deferred Features:** 7 items intentionally tabled (not bugs)
3. **Core Math:** All formulas working correctly ✅
4. **Edge Cases:** All protected ✅

### **What v3.2 Should Deliver:**
- ✅ Complete guardrail system (all 4 working)
- ✅ Preset mode spectrum (4 modes for different user types)
- ✅ Quiz system (epistemic bias detection + auto-mode)
- ✅ Polish from v3.0 maintained

### **Confidence Level:**
**HIGH** - No other forgotten features detected. Core system solid.

---

**This is the way.** 🔥
